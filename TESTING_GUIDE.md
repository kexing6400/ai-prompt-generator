# AI Prompt Generator 实时测试功能指南

## 概述

AI Prompt Generator 的实时测试功能为管理员提供了全面的系统验证和监控能力。通过可视化界面，您可以快速验证系统配置、测试AI模型性能，并监控整体系统健康状况。

## 功能特性

### 🔧 配置测试
- **API密钥验证**：一键验证OpenRouter API密钥的有效性
- **模型连接测试**：测试AI模型的连接状态和响应能力
- **数据库连接检查**：验证Supabase数据库连接
- **缓存功能测试**：检查系统缓存功能正常性

### ⚡ 实时生成测试
- **单模型测试**：测试指定AI模型的生成能力
- **多模型对比**：并行测试多个模型，比较性能表现
- **行业场景测试**：针对5大行业的专业提示词生成测试
- **响应时间监控**：实时显示生成响应时间和成本

### 🏥 系统健康检查
- **基础健康检查**：配置和连接状态验证
- **标准健康检查**：功能性测试和性能评估  
- **全面健康检查**：包含安全性和资源使用情况
- **历史趋势分析**：健康状态的历史数据和趋势

### 📊 测试用例管理
- **预设测试场景**：内置10个行业典型测试用例
- **自定义测试用例**：创建和管理个性化测试场景
- **批量测试执行**：一次性执行多个测试用例
- **测试结果分析**：详细的测试报告和性能统计

## 使用指南

### 1. 访问测试功能

1. 登录管理后台 (`/admin`)
2. 在模块导航中选择 **"实时测试"**
3. 选择相应的测试标签页

### 2. 配置测试操作

#### API密钥验证
```bash
操作路径：实时测试 > 配置测试 > API密钥验证
```
- 点击 **"测试"** 按钮
- 系统自动验证API密钥格式和有效性
- 显示验证结果和可用模型数量

#### 模型连接测试
```bash
操作路径：实时测试 > 配置测试 > 模型连接测试
```
- 系统选择默认或指定模型进行连接测试
- 发送测试请求验证模型响应
- 显示响应时间和连接状态

#### 一键全面测试
```bash
操作路径：实时测试 > 配置测试 > 一键全面测试
```
- 执行所有配置项的综合测试
- 显示整体成功率和详细报告
- 提供问题诊断和修复建议

### 3. 生成测试操作

#### 基础生成测试
1. 选择 **"生成测试"** 标签
2. 选择行业类型（法律、房产、保险、教育、会计）
3. 输入测试场景（如"合同审查"、"市场分析"）
4. 描述具体测试目标
5. 点击 **"开始生成测试"**

#### 多模型对比测试
- 系统自动使用所有启用的AI模型
- 并行执行生成任务
- 比较响应时间、生成质量和成本
- 识别最佳性能模型

### 4. 健康检查操作

#### 执行健康检查
```bash
操作路径：实时测试 > 健康检查 > 执行健康检查
```
- 点击 **"执行健康检查"** 按钮
- 系统执行标准级别的健康检查
- 显示各组件的健康状态

#### 健康状态解读
- **🟢 HEALTHY**：组件运行正常
- **🟡 DEGRADED**：组件有问题但仍可运行
- **🔴 FAILED**：组件故障，需要立即处理

### 5. 测试场景管理

#### 查看预设场景
- 系统内置10个行业测试场景
- 覆盖律师、房产、保险、教师、会计等行业
- 每个场景包含完整的测试参数和期望输出

#### 创建自定义场景
1. 点击 **"新建场景"** 按钮
2. 填写场景基本信息
3. 设置测试参数和期望结果
4. 保存并激活场景

## API接口说明

### 配置测试接口
```http
POST /api/admin/test/config
Content-Type: application/json

{
  "testType": "api_key" | "model_connection" | "database" | "cache" | "all",
  "modelId": "可选的特定模型ID",
  "timeout": 10000
}
```

### 生成测试接口
```http
POST /api/admin/test/generate
Content-Type: application/json

{
  "industry": "lawyer",
  "scenario": "合同审查",
  "goal": "审查商务合同",
  "requirements": "关注违约条款和风险点",
  "compareModels": true,
  "timeout": 30000
}
```

### 健康检查接口
```http
GET /api/admin/test/health?level=standard&includeHistory=false
```

### 测试用例管理接口
```http
# 获取测试场景
GET /api/admin/test/scenarios

# 创建测试场景
POST /api/admin/test/scenarios

# 执行批量测试
POST /api/admin/test/scenarios
{
  "scenarioIds": ["uuid1", "uuid2"],
  "modelIds": ["model1", "model2"],
  "timeout": 30000
}
```

## 性能监控

### 关键指标
- **响应时间**：API调用和生成的平均响应时间
- **成功率**：测试通过的百分比
- **模型性能**：不同AI模型的性能对比
- **资源使用**：内存和CPU使用情况

### 监控面板
- 实时性能图表
- 历史趋势分析
- 异常告警通知
- 性能优化建议

## 故障排除

### 常见问题

#### API密钥验证失败
**问题**：API密钥测试返回错误
**解决方案**：
1. 检查API密钥格式是否正确（应以`sk-or-`开头）
2. 验证API密钥是否在OpenRouter有效
3. 检查网络连接和防火墙设置
4. 确认API配额是否充足

#### 模型连接超时
**问题**：模型连接测试超时
**解决方案**：
1. 增加timeout设置（默认10秒）
2. 检查网络延迟情况
3. 尝试更换其他可用模型
4. 查看OpenRouter服务状态

#### 数据库连接失败
**问题**：数据库健康检查失败
**解决方案**：
1. 检查Supabase连接配置
2. 验证数据库访问权限
3. 确认数据库服务状态
4. 检查网络连接

### 错误代码说明

| 错误代码 | 描述 | 解决方案 |
|---------|------|----------|
| CONFIG_001 | API密钥无效 | 更新正确的API密钥 |
| CONFIG_002 | 模型连接失败 | 检查模型可用性 |
| CONFIG_003 | 数据库连接错误 | 验证数据库配置 |
| GENERATE_001 | 生成超时 | 增加timeout设置 |
| GENERATE_002 | 模型响应错误 | 检查模型状态 |
| HEALTH_001 | 健康检查失败 | 检查系统状态 |

## 最佳实践

### 测试频率建议
- **配置测试**：配置更改后立即执行
- **生成测试**：每日执行一次常规测试
- **健康检查**：每小时自动执行一次
- **批量测试**：每周执行一次全面测试

### 性能优化建议
1. **合理设置超时时间**：根据模型特性调整
2. **选择合适的测试级别**：避免过度测试影响性能
3. **定期清理测试数据**：保持数据库性能
4. **监控资源使用**：及时发现性能瓶颈

### 安全注意事项
1. **保护API密钥**：定期轮换和更新
2. **限制测试频率**：避免过度调用API
3. **监控异常访问**：及时发现安全威胁
4. **备份测试数据**：防止数据丢失

## 更新日志

### v1.0.0 (2025-01-09)
- ✅ 初始版本发布
- ✅ 配置测试功能
- ✅ 实时生成测试
- ✅ 系统健康检查
- ✅ 测试用例管理
- ✅ 可视化测试界面

### 计划功能
- 🔄 自动化测试调度
- 🔄 测试报告导出
- 🔄 性能基准对比
- 🔄 测试结果通知
- 🔄 A/B测试功能

## 技术支持

如需技术支持或功能建议，请联系：
- 📧 Email: support@ai-prompt-generator.com
- 📚 文档: [完整技术文档](https://docs.ai-prompt-generator.com)
- 🐛 问题反馈: [GitHub Issues](https://github.com/ai-prompt-generator/issues)

---

**注意**：实时测试功能需要管理员权限，请确保在安全环境下使用。建议在生产环境部署前，先在测试环境中验证所有功能。