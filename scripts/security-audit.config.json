{
  "name": "AI Prompt Generator 安全审计配置",
  "version": "1.0.0",
  "description": "comprehensive安全审计工具的配置文件",
  
  "auditRules": {
    "apiKeySecurity": {
      "enabled": true,
      "checkHardcoded": true,
      "checkFormat": true,
      "checkStrength": true,
      "minKeyLength": 20,
      "patterns": {
        "openRouter": "sk-or-[a-zA-Z0-9]{32,}",
        "openAI": "sk-[a-zA-Z0-9]{32,}",
        "supabase": "sb[a-zA-Z0-9]{32,}",
        "creem": "creem_[a-zA-Z0-9]{32,}"
      }
    },
    
    "environmentSecurity": {
      "enabled": true,
      "checkClientExposure": true,
      "checkGitTracking": true,
      "sensitiveKeywords": [
        "API_KEY", "SECRET", "PASSWORD", "TOKEN", "PRIVATE_KEY",
        "DATABASE_URL", "WEBHOOK_SECRET", "ENCRYPTION_KEY"
      ]
    },
    
    "xssProtection": {
      "enabled": true,
      "checkCSP": true,
      "checkSecurityHeaders": true,
      "requiredHeaders": [
        "Content-Security-Policy",
        "X-XSS-Protection", 
        "X-Content-Type-Options",
        "X-Frame-Options",
        "Referrer-Policy"
      ],
      "cspRequirements": {
        "default-src": ["'self'"],
        "script-src": ["'self'"],
        "style-src": ["'self'", "'unsafe-inline'"],
        "img-src": ["'self'", "data:", "https:"],
        "connect-src": ["'self'"],
        "font-src": ["'self'"],
        "object-src": ["'none'"],
        "frame-ancestors": ["'none'"]
      },
      "dangerousCSPValues": [
        "'unsafe-eval'",
        "'unsafe-inline'",
        "*",
        "data:"
      ]
    },
    
    "csrfProtection": {
      "enabled": true,
      "checkAPIRoutes": true,
      "checkOriginValidation": true,
      "exemptMethods": ["GET", "HEAD", "OPTIONS"]
    },
    
    "httpsConfiguration": {
      "enabled": true,
      "checkHSTS": true,
      "checkRedirects": true,
      "checkMixedContent": true,
      "requiredHSTSDirectives": [
        "max-age",
        "includeSubDomains"
      ]
    },
    
    "dependencyScanning": {
      "enabled": true,
      "checkVulnerabilities": true,
      "checkOutdated": true,
      "checkUnused": true,
      "severityThreshold": "moderate",
      "excludeDevDependencies": false,
      "trustedSources": [
        "npm",
        "@types",
        "@radix-ui",
        "@hookform",
        "@tailwindcss"
      ]
    },
    
    "sensitiveDataDetection": {
      "enabled": true,
      "checkHardcodedSecrets": true,
      "checkInfoLeaks": true,
      "checkDebugInfo": true,
      "patterns": {
        "passwords": "password\\s*[=:]\\s*['\"][^'\"]{8,}['\"]",
        "apiKeys": "['\"][a-zA-Z0-9]{32,}['\"]",
        "tokens": "token\\s*[=:]\\s*['\"][^'\"]{16,}['\"]",
        "emails": "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}",
        "urls": "https?://[^\\s'\"<>]+",
        "ips": "\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b"
      }
    },
    
    "inputValidation": {
      "enabled": true,
      "checkAPIValidation": true,
      "checkFormValidation": true,
      "checkSanitization": true,
      "requiredValidationLibraries": [
        "zod",
        "yup",
        "joi",
        "express-validator"
      ]
    },
    
    "outputEncoding": {
      "enabled": true,
      "checkXSSPrevention": true,
      "checkJSONSafety": true,
      "checkHTMLEscaping": true,
      "dangerousHTMLMethods": [
        "dangerouslySetInnerHTML",
        "innerHTML",
        "outerHTML"
      ]
    }
  },
  
  "reporting": {
    "format": "markdown",
    "includeOWASPMapping": true,
    "includeFixSuggestions": true,
    "includeSeverityAnalysis": true,
    "outputFile": "SECURITY_AUDIT_REPORT.md",
    "detailedReporting": true
  },
  
  "thresholds": {
    "critical": 0,
    "high": 3,
    "medium": 10,
    "low": 20
  },
  
  "exclusions": {
    "files": [
      "node_modules/",
      "dist/",
      "build/",
      ".next/",
      "coverage/",
      "test-results/",
      "*.min.js",
      "*.map"
    ],
    "patterns": [
      "// @security-ignore",
      "/* security:disable-line */"
    ]
  },
  
  "integration": {
    "ci": {
      "failOnCritical": true,
      "failOnHigh": true,
      "generateJUnitReport": false
    },
    "webhook": {
      "enabled": false,
      "url": "",
      "onSeverities": ["critical", "high"]
    }
  },
  
  "customRules": [
    {
      "name": "Next.js环境变量泄露检查",
      "pattern": "process\\.env\\.[A-Z_]+(?!NEXT_PUBLIC_)",
      "severity": "medium",
      "description": "检查是否有非公开环境变量在客户端代码中使用",
      "fix": "确保敏感环境变量仅在服务端使用"
    },
    {
      "name": "OpenRouter API密钥格式检查",
      "pattern": "OPENROUTER_API_KEY.*(?!sk-or-)",
      "severity": "high", 
      "description": "OpenRouter API密钥格式不正确",
      "fix": "确保使用正确格式的OpenRouter API密钥"
    },
    {
      "name": "Vercel函数环境检查",
      "pattern": "process\\.env\\.VERCEL_ENV.*production",
      "severity": "low",
      "description": "检查Vercel环境配置",
      "fix": "确保生产环境配置正确"
    }
  ],
  
  "owaspTop10Mapping": {
    "A01:2021": "Broken Access Control",
    "A02:2021": "Cryptographic Failures", 
    "A03:2021": "Injection",
    "A04:2021": "Insecure Design",
    "A05:2021": "Security Misconfiguration",
    "A06:2021": "Vulnerable and Outdated Components",
    "A07:2021": "Identification and Authentication Failures",
    "A08:2021": "Software and Data Integrity Failures",
    "A09:2021": "Security Logging and Monitoring Failures",
    "A10:2021": "Server-Side Request Forgery"
  }
}